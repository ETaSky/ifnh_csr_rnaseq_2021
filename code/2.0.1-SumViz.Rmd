---
title: "2- Summarize and Visualize feature count"
author: "Jincheng Wang"
date: "6/21/2021"
output: html_document
---

```{r renv_setup, include = TRUE, echo = FALSE, message = FALSE}
#renv::init() # only run once when the project is created.
renv::restore() # run every time when a different computer is used (practically it is Ok to run every time)
#renv::snapshot() # run every time in the end if there are new packages installed (practically it is Ok to run every time in the end)
```


```{r setup, include = TRUE, message=FALSE}

knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)

```

## Import outside files
1. Metadata

```{r}
mt_raw <- read.table("../data/Metadata_RNAseq_06072021-jw.txt", header = T, sep = "\t")
```

2. Salmon counts
Here we are importing the count estimate output from Salmon.
```{r}
library(tximeta)
# PE
dat_path = dir("../data/mapped_salmon/PE", pattern = "*_quant", full.names = T, recursive = F)
sample_id = gsub("_quant", "", basename(dat_path)) %>% gsub("-", "\\.", .)

# create sample table/sample manifest
coldata = data.frame(files = file.path(dat_path, "quant.sf"), names = sample_id) %>% merge(., mt_raw, by.x = "names", by.y = "TubeID", all.x = T)

# setTximetaBFC(dir = ../trash)
se = tximeta(coldata, type = "salmon")

```

```{r}

```

